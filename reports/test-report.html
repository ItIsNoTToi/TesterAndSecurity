<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:14,&quot;tests&quot;:25,&quot;passes&quot;:2,&quot;pending&quot;:0,&quot;failures&quot;:23,&quot;start&quot;:&quot;2024-11-09T07:26:54.963Z&quot;,&quot;end&quot;:&quot;2024-11-09T07:26:57.297Z&quot;,&quot;duration&quot;:2334,&quot;testsRegistered&quot;:25,&quot;passPercent&quot;:8,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;a9b1b780-0291-4900-9afe-75407192c500&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;{root}\&quot;&quot;,&quot;fullTitle&quot;:&quot;\&quot;before all\&quot; hook in \&quot;{root}\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:507,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Register and log in a test user to obtain the token\nconst loginResponse = await request(app)\n  .post(&#x27;/login&#x27;)\n  .send({\n    username: &#x27;admin&#x27;,\n    password: &#x27;Hung123456@&#x27;,\n  });\nuserId = loginResponse.body.userId;\ntoken = loginResponse.body.token; // Store token for use in tests&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;72d21303-5866-4263-b814-55cf05f1332c&quot;,&quot;parentUUID&quot;:&quot;a9b1b780-0291-4900-9afe-75407192c500&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;{root}\&quot;&quot;,&quot;fullTitle&quot;:&quot;\&quot;before all\&quot; hook in \&quot;{root}\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:320,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Register and log in a test user to obtain the token\nconst loginResponse = await request(app)\n  .post(&#x27;/login&#x27;)\n  .send({\n    username: &#x27;admin&#x27;,\n    password: &#x27;Hung123456@&#x27;,\n  });\nuserId = loginResponse.body.userId;\ntoken = loginResponse.body.token; // Store token for use in tests&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5869ddc9-66cc-4989-92b2-540ed321dfda&quot;,&quot;parentUUID&quot;:&quot;a9b1b780-0291-4900-9afe-75407192c500&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;{root}\&quot;&quot;,&quot;fullTitle&quot;:&quot;\&quot;before all\&quot; hook in \&quot;{root}\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:312,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Register and log in a test user to obtain the token\nconst loginResponse = await request(app)\n  .post(&#x27;/login&#x27;)\n  .send({\n    username: &#x27;admin&#x27;,\n    password: &#x27;Hung123456@&#x27;,\n  });\nuserId = loginResponse.body.userId;\ntoken = loginResponse.body.token; // Store token for use in tests&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ea02cf20-7722-4dc4-97b6-c76a3dfedff9&quot;,&quot;parentUUID&quot;:&quot;a9b1b780-0291-4900-9afe-75407192c500&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;5a773922-e9ec-4e18-96dc-8ac933231952&quot;,&quot;title&quot;:&quot;Friendship API&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ada2ad84-32e1-4378-a99b-4cb2dd0d799d&quot;,&quot;title&quot;:&quot;GET /listfriend&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return list of friends for logged-in user&quot;,&quot;fullTitle&quot;:&quot;Friendship API GET /listfriend should return list of friends for logged-in user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:90,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Giả sử có một người bạn trong cơ sở dữ liệu\nconst listFriendResponse = await request(app)\n  .get(&#x27;/friend/listfriend&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({\n    userId: userId\n  });\n  \nexpect(listFriendResponse.statusCode).to.equal(200);\nexpect(listFriendResponse.body.message).to.equal(&#x27;List of Friends&#x27;);\nexpect(listFriendResponse.body.friends).to.not.be.empty;&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 404 to equal 200&quot;,&quot;estack&quot;:&quot;AssertionError: expected 404 to equal 200\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/addfriend.test.mjs:44:50)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 200\n&quot;},&quot;uuid&quot;:&quot;aa51460e-f156-4898-b056-45e74e8ecafc&quot;,&quot;parentUUID&quot;:&quot;ada2ad84-32e1-4378-a99b-4cb2dd0d799d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 if no friends found&quot;,&quot;fullTitle&quot;:&quot;Friendship API GET /listfriend should return 404 if no friends found&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:43,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Giả sử người dùng chưa có bạn bè\nconst listFriendResponse = await request(app)\n  .get(&#x27;/friend/listfriend&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({\n    userId: userId\n  });\n  \nexpect(listFriendResponse.statusCode).to.equal(404);\nexpect(listFriendResponse.body.message).to.equal(&#x27;you have been not friend&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected undefined to equal &#x27;you have been not friend&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected undefined to equal &#x27;you have been not friend&#x27;\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/addfriend.test.mjs:59:52)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;},&quot;uuid&quot;:&quot;fda46d6e-6132-4058-9372-1c66a2a4ae63&quot;,&quot;parentUUID&quot;:&quot;ada2ad84-32e1-4378-a99b-4cb2dd0d799d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;aa51460e-f156-4898-b056-45e74e8ecafc&quot;,&quot;fda46d6e-6132-4058-9372-1c66a2a4ae63&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:133,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;214defd0-43fc-4543-8de6-9896e7f4ee87&quot;,&quot;title&quot;:&quot;GET /listrequestfriend&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return list of sent friend requests for logged-in user&quot;,&quot;fullTitle&quot;:&quot;Friendship API GET /listrequestfriend should return list of sent friend requests for logged-in user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const listRequestResponse = await request(app)\n  .get(&#x27;/friend/listrequestfriend&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({\n    userId: userId\n  });\n  \nexpect(listRequestResponse.statusCode).to.equal(200);\nexpect(listRequestResponse.body.message).to.equal(&#x27;Danh sach nhung nguoi da gui ket ban&#x27;);\nexpect(listRequestResponse.body.friends).to.not.be.empty;&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 404 to equal 200&quot;,&quot;estack&quot;:&quot;AssertionError: expected 404 to equal 200\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/addfriend.test.mjs:72:51)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 200\n&quot;},&quot;uuid&quot;:&quot;c6c69516-5743-48da-80df-fde57c650ab2&quot;,&quot;parentUUID&quot;:&quot;214defd0-43fc-4543-8de6-9896e7f4ee87&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 if no requests sent&quot;,&quot;fullTitle&quot;:&quot;Friendship API GET /listrequestfriend should return 404 if no requests sent&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:38,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const listRequestResponse = await request(app)\n  .get(&#x27;/friend/listrequestfriend&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({\n    userId: userId\n  });\n  \nexpect(listRequestResponse.statusCode).to.equal(404);\nexpect(listRequestResponse.body.message).to.equal(&#x27;Ban chua gui ket ban voi ai&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected undefined to equal &#x27;Ban chua gui ket ban voi ai&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected undefined to equal &#x27;Ban chua gui ket ban voi ai&#x27;\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/addfriend.test.mjs:86:53)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;},&quot;uuid&quot;:&quot;9392d7ed-a5e3-4aba-bfcc-0d030f55aedd&quot;,&quot;parentUUID&quot;:&quot;214defd0-43fc-4543-8de6-9896e7f4ee87&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;c6c69516-5743-48da-80df-fde57c650ab2&quot;,&quot;9392d7ed-a5e3-4aba-bfcc-0d030f55aedd&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:84,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6fee9955-1b7a-4674-bd1a-a213428d653b&quot;,&quot;title&quot;:&quot;POST /addfriend&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should send a friend request successfully&quot;,&quot;fullTitle&quot;:&quot;Friendship API POST /addfriend should send a friend request successfully&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:56,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const addFriendResponse = await request(app)\n  .post(&#x27;/friend/addfriend&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ \n    senderId: userId,\n    receiverId: mockReceiverId \n});\n  \nexpect(addFriendResponse.statusCode).to.equal(200);\nexpect(addFriendResponse.body.message).to.equal(&#x27;requested&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 404 to equal 200&quot;,&quot;estack&quot;:&quot;AssertionError: expected 404 to equal 200\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/addfriend.test.mjs:100:49)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 200\n&quot;},&quot;uuid&quot;:&quot;25542336-9858-41c6-a866-12231e9616ec&quot;,&quot;parentUUID&quot;:&quot;6fee9955-1b7a-4674-bd1a-a213428d653b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 if sending friend request to yourself&quot;,&quot;fullTitle&quot;:&quot;Friendship API POST /addfriend should return 400 if sending friend request to yourself&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const addFriendResponse = await request(app)\n  .post(&#x27;/friend/addfriend&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ senderId: userId, receiverId: mockUserId });\n  \nexpect(addFriendResponse.statusCode).to.equal(400);\nexpect(addFriendResponse.body.message).to.equal(&#x27;Cannot send a friend request to yourself&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 404 to equal 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected 404 to equal 400\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/addfriend.test.mjs:110:49)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 400\n&quot;},&quot;uuid&quot;:&quot;6b486913-2795-424e-8283-6e0a2e81be48&quot;,&quot;parentUUID&quot;:&quot;6fee9955-1b7a-4674-bd1a-a213428d653b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 if friend request already exists&quot;,&quot;fullTitle&quot;:&quot;Friendship API POST /addfriend should return 400 if friend request already exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const addFriendResponse = await request(app)\n  .post(&#x27;/friend/addfriend&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ senderId: userId, receiverId: mockReceiverId });\n  \nexpect(addFriendResponse.statusCode).to.equal(400);\nexpect(addFriendResponse.body.message).to.equal(&#x27;Friend request already exists&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 404 to equal 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected 404 to equal 400\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/addfriend.test.mjs:120:49)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 400\n&quot;},&quot;uuid&quot;:&quot;22afb034-56c2-4248-9e1e-720ac4579712&quot;,&quot;parentUUID&quot;:&quot;6fee9955-1b7a-4674-bd1a-a213428d653b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;25542336-9858-41c6-a866-12231e9616ec&quot;,&quot;6b486913-2795-424e-8283-6e0a2e81be48&quot;,&quot;22afb034-56c2-4248-9e1e-720ac4579712&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:156,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e9a1e0b8-7977-4c12-81b4-7d4cfe37eb14&quot;,&quot;title&quot;:&quot;POST /acceptfriend&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should accept a friend request successfully&quot;,&quot;fullTitle&quot;:&quot;Friendship API POST /acceptfriend should accept a friend request successfully&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:53,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Giả sử đã có yêu cầu kết bạn trong cơ sở dữ liệu\nconst acceptFriendResponse = await request(app)\n  .post(&#x27;/friend/acceptfriend&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ senderId: userId, requestId: mockReceiverId });\n  \nexpect(acceptFriendResponse.statusCode).to.equal(200);\nexpect(acceptFriendResponse.body.message).to.equal(&#x27;Friend request accepted successfully&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 404 to equal 200&quot;,&quot;estack&quot;:&quot;AssertionError: expected 404 to equal 200\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/addfriend.test.mjs:133:52)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 200\n&quot;},&quot;uuid&quot;:&quot;e74cc74c-3081-465c-814b-60638c7636b3&quot;,&quot;parentUUID&quot;:&quot;e9a1e0b8-7977-4c12-81b4-7d4cfe37eb14&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 if friend request not found&quot;,&quot;fullTitle&quot;:&quot;Friendship API POST /acceptfriend should return 404 if friend request not found&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:34,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const acceptFriendResponse = await request(app)\n  .post(&#x27;/friend/acceptfriend&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ senderId: userId, requestId: new mongoose.Types.ObjectId() });\n  \nexpect(acceptFriendResponse.statusCode).to.equal(404);\nexpect(acceptFriendResponse.body.message).to.equal(&#x27;Friend request not found or already processed&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ef374cd9-74d7-48c8-ba6b-d0ce3b7d40c9&quot;,&quot;parentUUID&quot;:&quot;e9a1e0b8-7977-4c12-81b4-7d4cfe37eb14&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ef374cd9-74d7-48c8-ba6b-d0ce3b7d40c9&quot;],&quot;failures&quot;:[&quot;e74cc74c-3081-465c-814b-60638c7636b3&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:87,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a1090e9e-eb53-4058-9226-0a9773c15568&quot;,&quot;title&quot;:&quot;POST /removeFriend&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\addfriend.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should remove a friend successfully&quot;,&quot;fullTitle&quot;:&quot;Friendship API POST /removeFriend should remove a friend successfully&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:36,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const removeFriendResponse = await request(app)\n  .post(&#x27;/friend/removeFriend&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ \n    senderId: userId, \n    receiverId: mockReceiverId \n    });\n  \nexpect(removeFriendResponse.statusCode).to.equal(200);\nexpect(removeFriendResponse.body.message).to.equal(&#x27;Friend removed successfully&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f0b9141e-af04-4273-a0aa-80cce649ecd5&quot;,&quot;parentUUID&quot;:&quot;a1090e9e-eb53-4058-9226-0a9773c15568&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 500 if an error occurs&quot;,&quot;fullTitle&quot;:&quot;Friendship API POST /removeFriend should return 500 if an error occurs&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:33,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Đặt lại mock để gây lỗi\nconst removeFriendResponse = await request(app)\n  .post(&#x27;/friend/removeFriend&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ senderId: userId, receiverId: new mongoose.Types.ObjectId() });\n  \nexpect(removeFriendResponse.statusCode).to.equal(500);\nexpect(removeFriendResponse.body.message).to.equal(&#x27;Server error&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 200 to equal 500&quot;,&quot;estack&quot;:&quot;AssertionError: expected 200 to equal 500\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/addfriend.test.mjs:169:52)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 200\n+ 500\n&quot;},&quot;uuid&quot;:&quot;7123a1e0-d921-4e62-a70c-2675fbcbda99&quot;,&quot;parentUUID&quot;:&quot;a1090e9e-eb53-4058-9226-0a9773c15568&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f0b9141e-af04-4273-a0aa-80cce649ecd5&quot;],&quot;failures&quot;:[&quot;7123a1e0-d921-4e62-a70c-2675fbcbda99&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:69,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;790584fc-a08d-4ddb-ad14-6268024a156c&quot;,&quot;title&quot;:&quot;Post API Tests&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\managerpost.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\managerpost.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;90e44bd0-61e9-4214-a549-a38c82c84889&quot;,&quot;title&quot;:&quot;GET /post&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\managerpost.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\managerpost.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return the post of the user&quot;,&quot;fullTitle&quot;:&quot;Post API Tests GET /post should return the post of the user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:85,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const postData = {\n  Author: fakeUserId,\n  content: &#x27;This is a test post&#x27;\n};\nconst post = await Post.create(postData);\nconst response = await request(app)\n  .get(&#x27;/post&#x27;)\n  .set(&#x27;Cookie&#x27;, [`userId=${fakeUserId}`])  // Mock session cookie\n  .send();\nexpect(response.status).to.equal(200);  // Correct assertion\nexpect(response.body.message).to.equal(&#x27;List your post&#x27;);  // Correct assertion\nexpect(response.body.post.content).to.equal(postData.content);  // Correct assertion\nawait post.remove();&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 401 to equal 200&quot;,&quot;estack&quot;:&quot;AssertionError: expected 401 to equal 200\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/managerpost.test.mjs:49:34)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;af36efc9-3092-4218-9540-e90723d52c71&quot;,&quot;parentUUID&quot;:&quot;90e44bd0-61e9-4214-a549-a38c82c84889&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 if no post found&quot;,&quot;fullTitle&quot;:&quot;Post API Tests GET /post should return 400 if no post found&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:34,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .get(&#x27;/post&#x27;)\n  .set(&#x27;Cookie&#x27;, [`userId=${fakeUserId}`])  // Mock session cookie\n  .send();\nexpect(response.status).to.equal(400);  // Correct assertion\nexpect(response.body.message).to.equal(&#x27;No post found&#x27;);  // Correct assertion&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 401 to equal 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected 401 to equal 400\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/managerpost.test.mjs:62:34)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 400\n&quot;},&quot;uuid&quot;:&quot;9f6aa738-d022-49d8-821e-ddff7227acf2&quot;,&quot;parentUUID&quot;:&quot;90e44bd0-61e9-4214-a549-a38c82c84889&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;af36efc9-3092-4218-9540-e90723d52c71&quot;,&quot;9f6aa738-d022-49d8-821e-ddff7227acf2&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:119,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;39649fdb-8c61-4a5e-a381-398680e5c0d8&quot;,&quot;title&quot;:&quot;POST /post&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\managerpost.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\managerpost.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a personal post&quot;,&quot;fullTitle&quot;:&quot;Post API Tests POST /post should create a personal post&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:38,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const postData = {\n  content: &#x27;This is a personal post&#x27;,\n  mediaIds: [], // Fake mediaIds for the post\n  communityId: null\n};\nconst response = await request(app)\n  .post(&#x27;/post&#x27;)\n  .set(&#x27;Cookie&#x27;, [`userId=${fakeUserId}`])  // Mock session cookie\n  .send(postData);\nexpect(response.status).to.equal(200);  // Correct assertion\nexpect(response.body.message).to.equal(&#x27;Personal post success&#x27;);  // Correct assertion&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 404 to equal 200&quot;,&quot;estack&quot;:&quot;AssertionError: expected 404 to equal 200\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/managerpost.test.mjs:81:34)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 200\n&quot;},&quot;uuid&quot;:&quot;608561cd-012c-49ca-a6af-6326378af695&quot;,&quot;parentUUID&quot;:&quot;39649fdb-8c61-4a5e-a381-398680e5c0d8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should create a community post&quot;,&quot;fullTitle&quot;:&quot;Post API Tests POST /post should create a community post&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const postData = {\n  content: &#x27;This is a community post&#x27;,\n  mediaIds: [], // Fake mediaIds for the post\n  communityId: new mongoose.Types.ObjectId()\n};\nconst response = await request(app)\n  .post(&#x27;/post&#x27;)\n  .set(&#x27;Cookie&#x27;, [`userId=${fakeUserId}`])  // Mock session cookie\n  .send(postData);\nexpect(response.status).to.equal(200);  // Correct assertion\nexpect(response.body.message).to.equal(&#x27;Community post success&#x27;);  // Correct assertion&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 404 to equal 200&quot;,&quot;estack&quot;:&quot;AssertionError: expected 404 to equal 200\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/managerpost.test.mjs:97:34)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 200\n&quot;},&quot;uuid&quot;:&quot;0cc7b021-0059-4b1f-ba7a-48c0b865e08f&quot;,&quot;parentUUID&quot;:&quot;39649fdb-8c61-4a5e-a381-398680e5c0d8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return error if communityId is missing for community post&quot;,&quot;fullTitle&quot;:&quot;Post API Tests POST /post should return error if communityId is missing for community post&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:33,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const postData = {\n  content: &#x27;This is a community post without communityId&#x27;,\n  mediaIds: [],\n  communityId: null\n};\nconst response = await request(app)\n  .post(&#x27;/post&#x27;)\n  .set(&#x27;Cookie&#x27;, [`userId=${fakeUserId}`])  // Mock session cookie\n  .send(postData);\nexpect(response.status).to.equal(400);  // Correct assertion\nexpect(response.body.message).to.equal(&#x27;Community ID is required for community posts.&#x27;);  // Correct assertion&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 404 to equal 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected 404 to equal 400\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/managerpost.test.mjs:113:34)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 400\n&quot;},&quot;uuid&quot;:&quot;364dfc27-f757-40da-b282-03e7c95c434b&quot;,&quot;parentUUID&quot;:&quot;39649fdb-8c61-4a5e-a381-398680e5c0d8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;608561cd-012c-49ca-a6af-6326378af695&quot;,&quot;0cc7b021-0059-4b1f-ba7a-48c0b865e08f&quot;,&quot;364dfc27-f757-40da-b282-03e7c95c434b&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:100,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;09cd0c66-861c-47be-878c-e237369c5efe&quot;,&quot;title&quot;:&quot;POST /like&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\managerpost.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\managerpost.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should like a post&quot;,&quot;fullTitle&quot;:&quot;Post API Tests POST /like should like a post&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const postData = {\n  content: &#x27;Test post to like&#x27;,\n  mediaIds: [],\n  communityId: null\n};\nconst post = await Post.create(postData);\nconst likeData = {\n  postId: post._id\n};\nconst response = await request(app)\n  .post(&#x27;/like&#x27;)\n  .set(&#x27;Cookie&#x27;, [`userId=${fakeUserId}`])  // Mock session cookie\n  .send(likeData);\nexpect(response.status).to.equal(200);  // Correct assertion\nexpect(response.body.message).to.equal(&#x27;like post success&#x27;);  // Correct assertion\n// Clean up by removing the post and like after the test\nawait post.remove();\nawait postlike.deleteMany({ post: post._id });&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 404 to equal 200&quot;,&quot;estack&quot;:&quot;AssertionError: expected 404 to equal 200\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/managerpost.test.mjs:138:34)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 200\n&quot;},&quot;uuid&quot;:&quot;0ea9baf4-dd0d-43c2-9572-94557875e0cb&quot;,&quot;parentUUID&quot;:&quot;09cd0c66-861c-47be-878c-e237369c5efe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should remove like if already liked&quot;,&quot;fullTitle&quot;:&quot;Post API Tests POST /like should remove like if already liked&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const postData = {\n  content: &#x27;Test post to remove like&#x27;,\n  mediaIds: [],\n  communityId: null\n};\nconst post = await Post.create(postData);\n// Simulate a like being created\nconst likeData = {\n  postId: post._id\n};\nawait postlike.create({\n  post: post._id,\n  User: fakeUserId\n});\nconst response = await request(app)\n  .post(&#x27;/like&#x27;)\n  .set(&#x27;Cookie&#x27;, [`userId=${fakeUserId}`])  // Mock session cookie\n  .send(likeData);\nexpect(response.status).to.equal(200);  // Correct assertion\nexpect(response.body.message).to.equal(&#x27;like post success&#x27;);  // Correct assertion\n// Clean up by removing the post and like after the test\nawait post.remove();\nawait postlike.deleteMany({ post: post._id });&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 404 to equal 200&quot;,&quot;estack&quot;:&quot;AssertionError: expected 404 to equal 200\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/managerpost.test.mjs:170:34)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 200\n&quot;},&quot;uuid&quot;:&quot;2a89dd21-015e-45ea-9386-787252a39500&quot;,&quot;parentUUID&quot;:&quot;09cd0c66-861c-47be-878c-e237369c5efe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;0ea9baf4-dd0d-43c2-9572-94557875e0cb&quot;,&quot;2a89dd21-015e-45ea-9386-787252a39500&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:97,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;22d11b8c-2626-497d-8437-6b6199e37215&quot;,&quot;title&quot;:&quot;Message API&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\message.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\message.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;b3c02910-74b2-4328-ad17-b83748d4c893&quot;,&quot;title&quot;:&quot;POST /sendMessage&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\message.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\message.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a new message with valid token&quot;,&quot;fullTitle&quot;:&quot;Message API POST /sendMessage should create a new message with valid token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:31,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .post(&#x27;/message/sendmessage&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`) // Add token to headers\n  .send({\n    content: \&quot;Hello, this is a test message!\&quot;,\n    chatId: &#x27;672efdffcda5fb545398bb4e&#x27;,\n    senderId: userId\n  });\nexpect(res.statusCode).to.equal(201);\nexpect(res.body.data.content).to.equal(\&quot;Hello, this is a test message!\&quot;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 401 to equal 201&quot;,&quot;estack&quot;:&quot;AssertionError: expected 401 to equal 201\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/message.test.mjs:40:33)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 201\n&quot;},&quot;uuid&quot;:&quot;b3e3024f-990a-449c-91f3-c1aab4dc5963&quot;,&quot;parentUUID&quot;:&quot;b3c02910-74b2-4328-ad17-b83748d4c893&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return error if content exceeds 500 characters&quot;,&quot;fullTitle&quot;:&quot;Message API POST /sendMessage should return error if content exceeds 500 characters&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .post(&#x27;/message/sendmessage&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({\n    content: &#x27;a&#x27;.repeat(501),\n    chatId: &#x27;672efdffcda5fb545398bb4e&#x27;\n  });\nexpect(res.statusCode).to.equal(400);\nexpect(res.body.message).to.equal(\&quot;Tin nhắn vượt quá giới hạn ký tự, vui lòng rút ngắn tin nhắn\&quot;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 401 to equal 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected 401 to equal 400\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/message.test.mjs:53:33)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 400\n&quot;},&quot;uuid&quot;:&quot;cea361f2-7b85-4a4e-97cf-20e24498cc99&quot;,&quot;parentUUID&quot;:&quot;b3c02910-74b2-4328-ad17-b83748d4c893&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return unauthorized error if token is missing&quot;,&quot;fullTitle&quot;:&quot;Message API POST /sendMessage should return unauthorized error if token is missing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:27,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .post(&#x27;/message/sendmessage&#x27;)\n  .send({\n    content: \&quot;This message should not be sent\&quot;,\n    chatId: &#x27;672efdffcda5fb545398bb4e&#x27;\n  });\nexpect(res.statusCode).to.equal(401);\nexpect(res.body.message).to.equal(\&quot;Access denied. No token provided.\&quot;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected undefined to equal &#x27;Access denied. No token provided.&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected undefined to equal &#x27;Access denied. No token provided.&#x27;\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/message.test.mjs:66:35)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;},&quot;uuid&quot;:&quot;00a5f0da-26ab-4904-9a22-9851596d903b&quot;,&quot;parentUUID&quot;:&quot;b3c02910-74b2-4328-ad17-b83748d4c893&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;b3e3024f-990a-449c-91f3-c1aab4dc5963&quot;,&quot;cea361f2-7b85-4a4e-97cf-20e24498cc99&quot;,&quot;00a5f0da-26ab-4904-9a22-9851596d903b&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:83,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;c9fb74e9-b689-4156-978d-45302744ce23&quot;,&quot;title&quot;:&quot;GET /getMessage&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\message.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\message.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get messages for a given chat with valid token&quot;,&quot;fullTitle&quot;:&quot;Message API GET /getMessage should get messages for a given chat with valid token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:27,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Seed a message\nconst res = await request(app)\n  .get(&#x27;/message&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ chatId: &#x27;672efdffcda5fb545398bb4e&#x27;});\nexpect(res.statusCode).to.equal(200);\nexpect(res.body.data.length).to.beGreaterThan(0);\nexpect(res.body.data[0].content).to.equal(message.content);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 401 to equal 200&quot;,&quot;estack&quot;:&quot;AssertionError: expected 401 to equal 200\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/message.test.mjs:79:33)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;731eb7b2-c680-4e47-8168-0386412e87d1&quot;,&quot;parentUUID&quot;:&quot;c9fb74e9-b689-4156-978d-45302744ce23&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 if chat does not exist&quot;,&quot;fullTitle&quot;:&quot;Message API GET /getMessage should return 404 if chat does not exist&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:27,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .get(&#x27;/message&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ chatId: new mongoose.Types.ObjectId() });\nexpect(res.statusCode).to.equal(404);\nexpect(res.body.message).to.equal(\&quot;Chat not found\&quot;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 401 to equal 404&quot;,&quot;estack&quot;:&quot;AssertionError: expected 401 to equal 404\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/message.test.mjs:90:33)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 404\n&quot;},&quot;uuid&quot;:&quot;e0c343b9-abc1-4218-93fb-47de5a7cecd8&quot;,&quot;parentUUID&quot;:&quot;c9fb74e9-b689-4156-978d-45302744ce23&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;731eb7b2-c680-4e47-8168-0386412e87d1&quot;,&quot;e0c343b9-abc1-4218-93fb-47de5a7cecd8&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:54,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9124c3d7-ac19-43ee-8fed-f34ecdb430b9&quot;,&quot;title&quot;:&quot;POST /messagelike&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\test\\Integration Test\\message.test.mjs&quot;,&quot;file&quot;:&quot;\\test\\Integration Test\\message.test.mjs&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should like a message with valid token&quot;,&quot;fullTitle&quot;:&quot;Message API POST /messagelike should like a message with valid token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:38,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const message = await Message.create({\n  content: &#x27;Like this message!&#x27;,\n  chatId: &#x27;672efdffcda5fb545398bb4e&#x27;,\n  senderId: &#x27;672af038edb1baeb8d1d1ac9&#x27;\n});\nconst res = await request(app)\n  .post(&#x27;/message/messagelike&#x27;)\n  .set(&#x27;Authorization&#x27;, `Bearer ${token}`)\n  .send({ messageId: &#x27;66f4532ddb2756c87a0a92c9&#x27; });\nexpect(res.statusCode).to.equal(201);\nexpect(res.body.message).to.equal(\&quot;Message liked successfully\&quot;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 401 to equal 201&quot;,&quot;estack&quot;:&quot;AssertionError: expected 401 to equal 201\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/message.test.mjs:108:33)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 201\n&quot;},&quot;uuid&quot;:&quot;479c6fb9-6102-44b0-b6e6-06f5bfcdfcf2&quot;,&quot;parentUUID&quot;:&quot;9124c3d7-ac19-43ee-8fed-f34ecdb430b9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return unauthorized error if token is missing&quot;,&quot;fullTitle&quot;:&quot;Message API POST /messagelike should return unauthorized error if token is missing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:26,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await request(app)\n  .post(&#x27;/message/messagelike&#x27;)\n  .send({ messageId: new mongoose.Types.ObjectId() });\nexpect(res.statusCode).to.equal(401);\nexpect(res.body.message).to.equal(\&quot;Access denied. No token provided.\&quot;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected undefined to equal &#x27;Access denied. No token provided.&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected undefined to equal &#x27;Access denied. No token provided.&#x27;\n    at Context.&lt;anonymous&gt; (file:///C:/Users/giang/Downloads/Tester/socialmessage/test/Integration%20Test/message.test.mjs:118:35)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)&quot;},&quot;uuid&quot;:&quot;13406e07-f13b-4e59-ae3d-70a9303c984e&quot;,&quot;parentUUID&quot;:&quot;9124c3d7-ac19-43ee-8fed-f34ecdb430b9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;479c6fb9-6102-44b0-b6e6-06f5bfcdfcf2&quot;,&quot;13406e07-f13b-4e59-ae3d-70a9303c984e&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:64,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.8.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;test-report&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;./reports&quot;,&quot;reportFilename&quot;:&quot;test-report&quot;,&quot;json&quot;:&quot;true&quot;,&quot;html&quot;:&quot;true&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;test-report&quot;,&quot;reportDir&quot;:&quot;./reports&quot;,&quot;reportTitle&quot;:&quot;socialmessage&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;reports\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\reports\\test-report.json&quot;,&quot;htmlFile&quot;:&quot;C:\\Users\\giang\\Downloads\\Tester\\socialmessage\\reports\\test-report.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>